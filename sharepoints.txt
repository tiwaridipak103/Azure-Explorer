from airflow import settings
from airflow.models import DagModel  # Import DagModel instead of DagRun
from sqlalchemy.orm import sessionmaker

# Create a session to interact with the database
Session = sessionmaker(bind=settings.engine)
session = Session()

# Find the old DAGs that are inactive (is_active = False)
old_dags = session.query(DagModel).filter(DagModel.is_active == False).all()

# Iterate through the results and set them to active
for dag in old_dags:
    dag.is_active = True  # Set is_active to True

# Commit the changes
session.commit()

# Close the session
session.close()
